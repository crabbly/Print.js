!function(e,t){"use strict";function r(e){return'<div style="'+d+'">'+e+"</div>"}function a(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function i(e){return e.charAt(0).toUpperCase()+e.slice(1)}function n(){return"undefined"!=typeof InstallTrigger}var o=["pdf","html","image","json"],s={printable:null,type:"pdf",header:null,maxWidth:800,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,properties:null,showModal:!1,modalMessage:"Retrieving Document...",frameId:"printJS",border:!0},p="max-width: "+s.maxWidth+"px !important;"+s.font_size+" !important;",d="font-family:"+s.font+" !important; font-size: "+s.font_size+" !important; width:100%;",l="font-weight:300;",h=t.getElementsByTagName("body")[0];e.printJS=function(){return void 0===arguments[0]?(e.console.error("printJS expects at least 1 attribute."),!1):void new m(arguments)};var m=function(){var e=arguments[0],r=this;switch(r.params=a({},s),typeof e[0]){case"string":r.params.printable=encodeURI(e[0]),r.params.type=e[1]||s.type;break;case"object":r.params.printable=e[0].printable,r.params.type=e[0].type||s.type,r.params.frameId=e[0].frameId||s.frameId,r.params.header=e[0].header||s.header,r.params.maxWidth=e[0].maxWidth||s.maxWidth,r.params.font=e[0].font||s.font,r.params.font_size=e[0].font_size||s.font_size,r.params.honorMarginPadding="undefined"!=typeof e[0].honorMarginPadding?e[0].honorMarginPadding:s.honorMarginPadding,r.params.properties=e[0].properties||s.properties,r.params.showModal="undefined"!=typeof e[0].showModal?e[0].showModal:s.showModal,r.params.modalMessage=e[0].modalMessage||s.modalMessage;break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+typeof e[0])}r.validateInput(),r.params.showModal&&r.showModal();var i=t.getElementById(r.params.frameId);switch(i&&i.parentNode.removeChild(i),r.printFrame=t.createElement("iframe"),r.printFrame.setAttribute("style","display:none;"),r.printFrame.setAttribute("id",r.params.frameId),r.params.type){case"pdf":r.pdf();break;case"image":r.image();break;case"html":r.html();break;case"json":r.json();break;default:throw new Error("Invalid printable type")}};m.prototype.pdf=function(){var e=(this.params.printable,this);if(e.params.showModal){var t=new Promise(function(t,r){var a=new XMLHttpRequest;a.responseType="blob",a.open("GET",e.params.printable),a.send(),t("PDF Loaded!")});t.then(function(){e.printFrame.setAttribute("src",e.params.printable),e.print()})}else e.printFrame.setAttribute("src",e.params.printable),e.print()},m.prototype.image=function(){var r=t.createElement("img");r.setAttribute("style","width:100%;"),r.src=this.params.printable;var a=new Promise(function(t,a){function i(){r.complete&&(e.clearInterval(n),t("Image loaded. Read to print!"))}var n=setInterval(i,100)}),i=this;a.then(function(e){var a=t.createElement("div");if(a.setAttribute("style","width:100%"),n){var o=t.createElement("canvas");o.setAttribute("width",r.width),o.setAttribute("height",r.height);var s=o.getContext("2d");s.drawImage(r,0,0),r.setAttribute("src",o.toDataURL("JPEG",1))}a.appendChild(r),i.params.header&&i.addHeader(a),i.printFrame.setAttribute("srcdoc",a.outerHTML),i.print()})},m.prototype.html=function(){var a=t.getElementById(this.params.printable);if(!a)return e.console.error("Invalid HTML element id: "+this.params.printable),!1;var i=t.createElement("div");i.appendChild(a.cloneNode(!0)),i.setAttribute("style","display:none;"),i.setAttribute("id","printJS-html"),a.parentNode.appendChild(i),i=t.getElementById("printJS-html"),i.setAttribute("style",this.collectStyles(i)+"margin:0 !important;");var n=i.children;this.loopNodesCollectStyles(n),this.params.header&&this.addHeader(i),this.printFrame.srcdoc=r(i.innerHTML),i.parentNode.removeChild(i),this.print()},m.prototype.json=function(){if("object"!=typeof this.params.printable)throw new Error("Invalid javascript data object (JSON).");if(!this.params.properties||"object"!=typeof this.params.properties)throw new Error("Invalid properties array for your JSON data.");var e="";this.params.header&&(e+='<h1 style="'+l+'">'+this.params.header+"</h1>"),e+=this.jsonToHTML(),e=r(e),this.printFrame.setAttribute("srcdoc",e),this.print()},m.prototype.print=function(){var e=this;h.appendChild(this.printFrame);var r=this.params.frameId;this.printFrame.onload=function(){var a=t.getElementById(r);a.focus(),a.contentWindow.print(),e.params.showModal&&e.disablePrintModal()}},m.prototype.collectStyles=function(r){var a=t.defaultView||e,i=[],n="";if(a.getComputedStyle){i=a.getComputedStyle(r,"");for(var o=0;o<i.length;o++){var s=["border","float","box"],d=["clear","display","width","min-width","height","min-height","max-height"];this.params.honorMarginPadding&&d.push("margin","padding"),this.params.honorColor&&d.push("color");for(var l=0;l<d.length;l++)-1===i[o].indexOf(s[l])&&0!==i[o].indexOf(d[l])||(n+=i[o]+":"+i.getPropertyValue(i[o])+";")}}else if(r.currentStyle){i=r.currentStyle;for(var h in i)-1!==i.indexOf("border")&&-1!==i.indexOf("color")&&(n+=h+":"+i[h]+";")}return n+=p},m.prototype.loopNodesCollectStyles=function(e){for(var r=0;r<e.length;r++){var a=e[r],i=a.tagName;if("INPUT"==i||"TEXTAREA"==i||"SELECT"==i){var n=this.collectStyles(a),o=a.parentNode,s="SELECT"==i?t.createTextNode(a.options[a.selectedIndex].text):t.createTextNode(a.value),p=t.createElement("div");p.appendChild(s),p.setAttribute("style",n),o.appendChild(p),o.removeChild(a)}else a.setAttribute("style",this.collectStyles(a));var d=a.children;d.length&&this.loopNodesCollectStyles(d)}},m.prototype.addHeader=function(e){var r=t.createElement("h1"),a=t.createTextNode(this.params.header);r.appendChild(a),r.setAttribute("style",l),e.insertBefore(r,e.childNodes[0])},m.prototype.jsonToHTML=function(){var e=this.params.printable,t=this.params.properties,r='<div style="display:flex; flex-direction: column;">';r+='<div style="flex:1; display:flex;">';for(var a=0;a<t.length;a++)r+='<div style="flex:1; padding:5px;">'+i(t[a])+"</div>";r+="</div>";for(var n=0;n<e.length;n++){r+='<div style="flex:1; display:flex;',r+=this.params.border?"border:1px solid lightgray;":"",r+='">';for(var o=0;o<t.length;o++)r+='<div style="flex:1; padding:5px;">'+e[n][t[o]]+"</div>";r+="</div>"}return r+="</div>"},m.prototype.validateInput=function(){if(!this.params.printable)throw new Error("Missing printable information.");if(!this.params.type||"string"!=typeof this.params.type||-1==o.indexOf(this.params.type.toLowerCase()))throw new Error("Invalid print type. Available types are: pdf, html, image and json.")},m.prototype.showModal=function(){var e="font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;",r=t.createElement("div");r.setAttribute("style",e),r.setAttribute("id","printJS-Modal");var a=t.createElement("div");a.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var i=t.createElement("div");i.setAttribute("class","printClose"),i.setAttribute("id","printClose"),a.appendChild(i);var n=t.createElement("span");n.setAttribute("class","printSpinner"),a.appendChild(n);var o=t.createTextNode(this.params.modalMessage);a.appendChild(o),r.appendChild(a),h.appendChild(r);var s=this;t.getElementById("printClose").addEventListener("click",function(){s.disablePrintModal()})},m.prototype.disablePrintModal=function(){var e=t.getElementById("printJS-Modal");e.parentNode.removeChild(e)}}(window,document);